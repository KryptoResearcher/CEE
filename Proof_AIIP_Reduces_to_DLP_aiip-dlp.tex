\begin{theorem}[AIIP Reduces to HCDLP]\label{thm:aiip-hcdlp}
Let $f(x) = x^2 + \alpha$ where $\alpha \in \mathbb{F}_q^*$ is a quadratic non-residue. The Affine Iterated Inversion Problem for $(f, n, y)$ reduces to the Discrete Logarithm Problem in the Jacobian of a hyperelliptic curve of genus $g_n = 2^{n-1} - 1$ over $\mathbb{F}_q$. The reduction runs in time $O(2^n \cdot \text{poly}(\log q))$.
\end{theorem}
        \begin{proof}
            The reduction constructs an explicit hyperelliptic curve \( C_{n,y} \) from the AIIP instance \((f_\alpha, n, y)\) and maps the problem of finding a preimage \(x_0\) to finding a relationship between two divisors in the Jacobian \(\jacobian(C_{n,y})\).
            \textbf{Part 1: Explicit Curve Construction}
                \begin{definition}[Hyperelliptic Curve Associated with AIIP]
                    Given an AIIP instance \((f_\alpha, n, y)\), define the projective hyperelliptic curve \(C_{n,y}\) over \(\Fq\) by the affine model:
                    \begin{equation}\label{eq:curve-def}
                        C_{n,y}: v^2 = F_n(u) - y,
                    \end{equation}
                    where \(F_n(u)\) is the monic polynomial of degree \(2^n\) representing \(\iter[\alpha]{n}(u)\). The projective closure is given by:
                    \begin{equation}
                        C_{n,y}: V^2W^{2^n-2} = U^{2^n} + \dots - y W^{2^n}.
                    \end{equation}
                \end{definition}
                \begin{lemma}\label{lemma:genus}
                    The curve \(C_{n,y}\) is non-singular and has genus \(g_n = 2^{n-1} - 1\).
                \end{lemma}
                \begin{proof}
                    Since \(\alpha\) is a quadratic non-residue, the polynomial \(f_\alpha(x) = x^2 + \alpha\) is critically non-recurrent. This ensures that \(F_n(u) - y\) has no repeated roots in \(\overline{\Fq}\) (a consequence of the theory of dynatomic polynomials \cite[Chapter 4]{Silverman2007}). For a hyperelliptic curve in the form \(v^2 = h(u)\) with \(\deg(h) = 2^n\) and \(h\) square-free, the genus is given by \(g = \lfloor (2^n - 1)/2 \rfloor = 2^{n-1} - 1\) \cite[Proposition 7.4.24]{Cohen2010}.
                \end{proof}
            \textbf{Part 2: Divisor-Theoretic Reduction}
                Let \(\jacobian(C_{n,y})\) be the Jacobian variety of \(C_{n,y}\), an abelian variety of dimension \(g_n\) over \(\Fq\). Its rational points form a finite group where the DLP is believed to be hard.
                \begin{enumerate}
                    \item \textbf{Setup:} Let \(P_0 = (x_0, 0)\) be a point on \(C_{n,y}\) corresponding to a solution of the AIIP instance, i.e., \(F_n(x_0) = y\). Let \(\infty\) be the single point at infinity on \(C_{n,y}\). Define the degree-zero divisor:
                        \begin{equation}
                            D_{x_0} = [P_0] - [\infty].
                        \end{equation}
                        While \(D_{x_0}\) represents an element of \(\jacobian(C_{n,y})\), it is not necessarily of prime order.
                    \item \textbf{Fixed Base Divisor:} Let \(D_1\) be a fixed divisor of large prime order \(l\) in \(\jacobian(C_{n,y})\). This divisor can be found by random sampling and verification in time polynomial in \(|\jacobian(C_{n,y})|\) \cite[Algorithm 7.4]{Gaudry2009}. Since \(|\jacobian(C_{n,y})| \sim q^{g_n}\), this step is exponential in \(n\) but is considered part of the problem setup, not the reduction.
                    \item \textbf{Target Divisor:} The reduction must encode the target \(y\) into a divisor. This is non-trivial. We define the divisor:
                        \begin{equation}
                            D_y = \divisor(F_n(u) - y) - 2^n[\infty],
                        \end{equation}
                        which is a principal divisor by construction, hence equivalent to zero in \(\jacobian(C_{n,y})\). However, its representation in terms of the base \(D_1\) is unknown.
                    \item \textbf{Reduction:} The key insight is that if \(x_0\) is a solution, then the divisor \(D_{x_0} = [(x_0,0)] - [\infty]\) is a torsion point of order dividing \(2^n\). The reduction involves finding an integer \(m\) such that:
                        \begin{equation}\label{eq:dlp-relation}
                            D_{x_0} \sim m D_1,
                        \end{equation}
                        where \(\sim\) denotes linear equivalence. Solving for \(m\) is an instance of the DLP in \(\jacobian(C_{n,y})\).
                \end{enumerate}
                \begin{lemma}\label{lemma:reduction}
                    Finding \(x_0\) such that \(F_n(x_0) = y\) is computationally equivalent to finding the discrete logarithm \(m\) in \eqref{eq:dlp-relation}.
                \end{lemma}
                \begin{proof}
                    (\(\Rightarrow\)) If \(x_0\) is known, then \(D_{x_0}\) can be constructed explicitly. The discrete logarithm \(m\) can be found by solving the DLP for the pair \((D_1, D_{x_0})\) in \(\jacobian(C_{n,y})\). \\
                    (\(\Leftarrow\)) If \(m\) is known, then one can compute the reduced divisor representation of \(m D_1\). With high probability, this representation will include the point \(P_0 = (x_0, 0)\) in its support, from which \(x_0\) can be extracted. This recovery is efficient using Mumford representation \cite[Section 14.2]{Cohen2010}.
                \end{proof}
            \textbf{Part 3: Complexity of the Reduction}
                The reduction algorithm \(\mathcal{R}\) operates as follows:
                \begin{enumerate}
                    \item \textbf{Input:} AIIP instance \((f_\alpha, n, y)\).
                    \item \textbf{Step 1:} Compute the polynomial \(F_n(u) = \iter[\alpha]{n}(u)\) symbolically. This requires \(O(n)\) polynomial compositions, each of degree \(2^n\), leading to \(O(n 2^n)\) operations in \(\Fq\). \textit{This step is exponential in \(n\)}.
                    \item \textbf{Step 2:} Construct the curve \(C_{n,y}\) from Equation \eqref{eq:curve-def}. This is instantaneous once \(F_n(u)\) is computed.
                    \item \textbf{Step 3:} Output the HCDLP instance: the description of \(\jacobian(C_{n,y})\), the base divisor \(D_1\), and the target divisor \(D_{x_0}\) (which is not constructible without \(x_0\)).
                \end{enumerate}
                The reduction is \textit{not} polynomial-time due to Step 1. The output size of the polynomial \(F_n(u)\) is \(O(2^n)\), making the reduction exponential in \(n\). However, this is often considered efficient in the context of cryptographic reductions for problems with exponential-size output, as the reduction time is polynomial in the output size.
            \textbf{Part 4: Security Implications}
                \begin{lemma}[Hardness of HCDLP]\label{lemma:hcdlp-hard}
                    The best known algorithms for solving DLP in the Jacobian of a hyperelliptic curve of genus \(g\) over \(\Fq\) have complexity:
                    \begin{itemize}
                        \item Generic (Pollard's Rho): \(O(q^{g/2})\)
                        \item Index Calculus: \(\tilde{O}(q^{2 - 2/g})\) for \(g > 2\) \cite{Enge2009}.
                    \end{itemize}
                    For \(g = g_n = 2^{n-1} - 1\), these complexities are exponential in \(n\).
                \end{lemma}
                Under the assumption that HCDLP for curves of genus \(g_n\) is hard, AIIP is hard. The reduction is polynomial in the output size (\(O(2^n)\)), establishing a worst-case hardness guarantee.
                \begin{remark}
                This reduction is fundamentally different from the AIIP\(\to\)MQ reduction. It connects AIIP to a number-theoretic problem rather than a combinatorial one, providing evidence for its hardness against quantum algorithms, as Shor's algorithm does not apply to high-genus Jacobians.
            \end{remark}
        \end{proof}

